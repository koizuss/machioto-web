<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>place2play</title>
<script type="text/javascript" src="javascripts/jquery-1.5.2.min.js"></script>
<!-- <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script> -->
<script type="text/javascript">
	var gps = navigator.geolocation;
	var currentPosition = null;
	
	var successCallback = function(position){
		currentPosition = position;
		// alert('latitude: ' + position.coords.latitude + ', longitude: ' + position.coords.longitude);
	};
	
	var errorCallback = function(error){
		alert('code: ' + error.code + ', message: ' + error.message);
	};
	
	var updatePosition = function(){
		gps.getCurrentPosition(successCallback, errorCallback);
	};
	
	$(function(){
		$('#position').click(function(){
			// alert('search position');
			updatePosition();
		});
		
		$('#put-entry').click(function(){
			// TODO: validation
			gps.getCurrentPosition(
					function(position){
						var data = {
							url: $('#url').val(),
							latitude: position.coords.latitude,
							longitude: position.coords.longitude,
						};
						
						// TODO: change method
						// TODO: callback function
						$.ajax({
							type: 'GET',
							url: '/entry/put',
							dataType: 'json',
							data: data,
							success: function(result){
								$(result).each(function(){
									alert(this.url);
								});
								},
							error: function(obj, status, msg){ alert(status + ': ' + msg); },
						});
					},
					errorCallback);
					// TODO: errorCallback
		});
	});
	// alert("test");
	
	// TODO:delete alert

</script>
</head>
<body>
<p>place2play<p>
<form action="/application/index" method="post">
<input type="submit" value="index"> 
</form>
<button id="position">update position</button>
<hr>
<div id="put-entry-form">
	<p>put entry</p>
	<input id="url" type="text" size="70">
	<button id="put-entry">done</button>
</div>
<hr>
<ul id="list">
</ul>
</body>
</html>